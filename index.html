<!doctype html>

<html lang="en">
<head>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js"></script>
	<script src="prova.js" type="text/javascript"></script>
	<title>Prova sensori</title>
	<meta charset="utf-8">
	<meta name="description" content="The HTML5 Herald">
	<meta name="author" content="SitePoint">

</head>

<body>
	<h1> Accelerometer </h1>
	<p>Data: </p>
	<div id='status'> No data from sensor </div>
	<div id='status_val'> No  prec , no actual </div>
	<div id='status_act'> Activity </div>
	<script>
		var prec=0;
		var act=0;
		var l=[];
		var i=0;
		let sensor = new Accelerometer({frequency: 1});
		sensor.start();
		sensor.onreading = () => {
			l[0]= sensor.x.toFixed(2) ;
			l[1]= sensor.y.toFixed(2) ;
			l[2]= sensor.z.toFixed(2) ;
			document.getElementById('status').innerHTML = "Acceleration: " + l[0] +"	" + l[1] + "	" + l[2];
			act=Math.sqrt(l[0]^2 + l[1]^2 + l[2]^2 ).toFixed(2);
			document.getElementById('status_val').innerHTML = "Actual: " + act +" previous:	" + prec;
			var d = Math.abs(act - prec).toFixed(2)
			if ( d > 5){
				i = i+1;
				document.getElementById('status_act').innerHTML = "Activity: Walking  i:  " + i;
			}else{
				document.getElementById('status_act').innerHTML = "Activity: stunning  i:  " + i ;
			}
			prec = act;
		};
		sensor.onerror = event => {
			document.getElementById('status').innerHTML = "Error Name" + event.error.name + "Error Message " + event.error.message;
		};
		
	    
		
	</script>
	<p>Stato connesione MQTT </p>
	
	<div id ='client_status'> No client  </div>
	<div id ='con_status'> Non connesso </div>
	<div id ='msg_status'> No msg send </div>
	
</body>
</html>
